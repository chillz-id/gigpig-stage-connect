{
  "id": "mcp-tools-not-accessible-2025-08",
  "type": "critical-issue",
  "severity": "critical",
  "title": "MCP Tools Not Accessible - Missing Personal Access Token",
  "date": "2025-08-08",
  "symptoms": [
    "MCP tools like list_tables return 'No such tool available'",
    "execute_sql, create_issue, send_message tools not accessible",
    "Claude Code can't access any MCP functionality",
    "API calls work directly but MCP tools don't"
  ],
  "root_cause": {
    "primary": "Missing Supabase Personal Access Token",
    "details": "MCP servers require specific Personal Access Tokens (different from API keys) to start. Without proper tokens, MCP servers fail to initialize, making all tools unavailable.",
    "specific_missing": "SUPABASE_ACCESS_TOKEN in .mcp.json had placeholder instead of real token"
  },
  "investigation_time": "3 hours",
  "wrong_paths_taken": [
    "Testing tool naming conventions (mcp__supabase__list_tables)",
    "Looking for MCP server processes",
    "Testing MCP gateway on various ports",
    "Assuming it was a tool naming issue"
  ],
  "solution": {
    "steps": [
      "Generate Supabase Personal Access Token at https://supabase.com/dashboard/account/tokens",
      "Add token to .env: SUPABASE_ACCESS_TOKEN=sbp_xxx",
      "Update .mcp.json to use real token instead of placeholder",
      "Restart Claude Code to reload MCP configuration"
    ],
    "verification": "Run node verify-mcp-ready.js to check all tokens",
    "result": "All 28+ Supabase MCP tools become accessible"
  },
  "prevention": {
    "mandatory_checks": [
      "Include MCP verification in startup checks",
      "Run verify-mcp-ready.js on every session start",
      "Check for placeholder tokens in .mcp.json"
    ],
    "documentation": "Create MCP_TOKEN_REQUIREMENTS.md with all token requirements"
  },
  "impact": {
    "severity": "total-mcp-failure",
    "affected_tools": [
      "All 28+ Supabase database tools",
      "All GitHub repository management tools",
      "All Slack communication tools",
      "All Notion documentation tools"
    ],
    "user_experience": "Complete inability to use MCP tools despite them being configured"
  },
  "lessons_learned": [
    "MCP servers have different authentication requirements than direct APIs",
    "Personal Access Tokens are different from API keys",
    "Always verify token configuration, not just presence",
    "MCP servers must start successfully for tools to be available"
  ],
  "related_files": [
    "/root/agents/.mcp.json",
    "/root/agents/.env",
    "/root/agents/verify-mcp-ready.js",
    "/root/agents/MCP_ROOT_CAUSE_ANALYSIS_AND_SOLUTION.md"
  ],
  "tags": ["mcp", "authentication", "tokens", "supabase", "critical-failure"],
  "user_quote": "Why the fuck are they not accessible in the current session?"
}